!function(t){"use strict";var n=!1,s=function(n){this.options=t.extend(!0,{template:"default",skin:"skin-1",content:{},close_button:!0,button_position:"right",animations:{delay:600,open:"bs-animate bs-fadeInDown",close:"bs-animate bs-fadeOutUp"},buttons:{},events:{before_click:function(){return!0},clicked:function(){return!0}},styles:{modal:"",container:""},is_vertical_center:!0},n),this.$modal=!1,this.$overlay=!1,this.timerTimeouts=[],this.$document=!1,this.init()};s.prototype={templates:{"default":'\n<div class="bs-modal-default"  {{#inline_style}} style="{{inline_style}}" {{/inline_style}}>\n    {{#close_button}}\n    <a href="#" class="bs-close-modal">\n        <i class="fa fa-times" aria-hidden="true"></i>\n    </a>\n    {{/close_button}}\n    <div class="bs-modal-header-wrapper bs-modal-clearfix">\n        <h2 class="bs-modal-header">\n            {{#icon}}\n            <i class="fa {{icon}}"></i>\n            {{/icon}}\n\n            {{header}}\n        </h2>\n    </div>\n\n    <div class="bs-modal-body">\n        {{{bs_body}}}\n    </div>\n\n    {{#bs_buttons}}\n    <div class="bs-modal-bottom bs-modal-buttons-{{btn_position}} bs-modal-clearfix">\n        {{{bs_buttons}}}\n    </div>\n    {{/bs_buttons}}\n</div>',single_image:'\n<div class="bs-modal-default" {{#inline_style}} style="{{inline_style}}" {{/inline_style}}>\n    {{#close_button}}\n    <a href="#" class="bs-close-modal">\n        <i class="fa fa-times" aria-hidden="true"></i>\n    </a>\n    {{/close_button}}\n    <div class="bs-modal-header-wrapper bs-modal-clearfix">\n        <h2 class="bs-modal-header">\n            {{#icon}}\n            <i class="fa {{icon}}"></i>\n            {{/icon}}\n\n            {{header}}\n        </h2>\n    </div>\n\n    <div class="bs-modal-body bf-clearfix">\n        <img src="{{image_src}}"{{#image_align}} align="{{image_align}}"{{/image_align}} {{#image_style}} style="{{image_style}}"{{/image_style}}/>\n        {{{bs_body}}}\n    </div>\n\n    {{#bs_buttons}}\n    <div class="bs-modal-bottom bs-modal-buttons-left bs-modal-clearfix">\n        {{{bs_buttons}}}\n        \n        {{#checkbox}}\n        <div class="bs-modal-checkbox">\n            <input type="checkbox" name="include_content" class="toggle-content" value="1" checked="checked"> <label class="checkbox-label">{{checkbox_label}}</label>\n        </div>\n        {{/checkbox}}\n    </div>\n    {{/bs_buttons}}\n</div>'},skins:{"skin-1":'<div class="bs-modal-description">\n    <h3 class="bs-modal-title">{{title}}</h3>\n    \n    {{{body}}}\n</div>',loading:' <div class="bs-modal-loading">\n     <div class="la-line-scale-pulse-out-rapid la-2x">\n         <div></div>\n         <div></div>\n         <div></div>\n         <div></div>\n         <div></div>\n     </div>\n     \n     <div class="bs-modal-loading-heading">\n         <h4>{{loading_heading}}</h4>\n     </div>\n</div>\n',success:' <div class="bs-modal-success">\n     \n     <i class="fa fa-thumbs-o-up" aria-hidden="true"></i>\n     \n     <div class="bs-modal-bs-modal-success-heading">\n         <h4>{{success_heading}}</h4>\n     </div>\n</div>\n'},button_struct:'<a {{#href}}href="{{href}}"{{/href}} {{#btn_classes}}class="{{btn_classes}}"{{/btn_classes}} id="{{id}}">{{label}}</a>',debug:function(t){console.error(t)},get_html:function(n,s,e){if("undefined"==typeof this.templates[n])return this.debug("invalid template name"),!1;if("undefined"==typeof this.skins[s])return this.debug("invalid skin"),!1;Mustache.parse(this.templates[n]);Mustache.parse(this.skins[s]);var i=Mustache.render(this.skins[s],e),o={bs_body:i,bs_buttons:this.generate_buttons(),close_button:this.options.close_button,inline_style:this.options.styles.modal,btn_position:this.options.button_position};return Mustache.render(this.templates[n],t.extend(e,o))},after_append_html:function(){this.options.is_vertical_center&&this.make_vertical_center(),this.handle_event("modal_loaded",this)},after_close_modal:function(){t(window).off("resize.bs-modal")},has_button:function(){return"object"==typeof this.options.buttons},append_html:function(){var t=this.get_html(this.options.template,this.options.skin,this.options.content);return"string"!=typeof t?t:(this.$modal.html(t),this.after_append_html(),!0)},generate_buttons:function(){if(!this.has_button())return"";Mustache.parse(this.button_struct);var t="";for(var n in this.options.buttons)t+="\n",t+=Mustache.render(this.button_struct,this.get_button_replacement_object(n));return t},get_button_replacement_object:function(n){if("object"!=typeof this.options.buttons[n])return this.debug("invalid button id"),{};var s=t.extend({focus:!1},this.options.buttons[n]);return delete s.clicked,s.id=n,"string"!=typeof s.btn_classes&&(s.btn_classes=""),-1!==t.inArray(s.type,["primary","secondary"])&&(s.btn_classes+=" bs-modal-btn-"+s.type),s.focus&&(s.btn_classes+=" bs-modal-btn-focus"),s},close_modal:function(s){var e=this,s=s||"callback";e.handle_event("modal_close",this,s);for(var i=0;i<this.timerTimeouts.length;i++)clearTimeout(this.timerTimeouts[i]);e.$modal.removeClass(this.options.animations.open).addClass(this.options.animations.close).delay(this.options.animations.delay).queue(function(t){e.$modal.hide().removeClass(e.options.animations.close).remove(),t()}),e.$overlay.fadeOut(this.options.animations.delay,function(){t(this).remove(),e.$document.removeClass("modal-open"),e.keyup_unbind(),n=!1,e.handle_event("modal_closed",this,s)}),e.after_close_modal()},keyup_unbind:function(){this.$document.off("keyup.bs-modal")},handle_event:function(t,n){var s=Array.prototype.slice.call(arguments,2);return"function"==typeof this.options.events[t]?this.options.events[t].apply(this,[n,this.options].concat(s)):void 0},handle_timer:function(t){var n=this;this.timerTimeouts.push(setTimeout(function(){t.callback.call(n,n.option)},t.delay))},change_skin:function(n){var s=t.extend(!0,{template:this.options.template,skin:this.options.skin,content:this.options.content,animations:{open:!1,body:!1,delay:20},buttons:{}},n);this.options.buttons=s.buttons;var e=this.get_html(s.template,s.skin,s.content);return"string"!=typeof e?e:(this.$modal.html(e).removeClass(this.options.animations.open).delay(20).queue(function(n){s.animations.open&&t(this).addClass(s.animations.open),n()}).removeClass(function(t,n){return(n.match(/(^|\s)skin-\S+/g)||[]).join(" ")}).addClass("skin-"+s.skin).find(".bs-modal-body").addClass(s.animations.body),"object"==typeof s.timer&&this.handle_timer(s.timer),void this.after_append_html())},make_vertical_center:function(){var n=this;t(window).on("resize.bs-modal",function(){var t=n.$modal.innerHeight(),s=window.innerHeight;if(s>t)var e=Math.ceil((s-t)/2);else var e=35;n.$modal.css("top",e)}).resize()},init:function(){this.$document=t(document.body);var s=this;if(n)return!1;var e={inline_style:this.options.styles.container};this.$document.append(Mustache.render('<div class="bs-modal-overlay"></div><div class="bs-modal" {{#inline_style}} style="{{inline_style}}" {{/inline_style}}></div>',e)),this.$modal=this.$document.find(".bs-modal"),this.$overlay=this.$document.find(".bs-modal-overlay"),this.$modal.on("click","a",function(n){if(s.handle_event("before_click",this)){var e=t(this),i=e.attr("id");if(e.hasClass("bs-close-modal"))n.preventDefault(),s.close_modal("btn");else if(i&&"object"==typeof s.options.buttons[i]){var o=s.options.buttons[i];switch(o.action){case"close":s.close_modal("link")}"function"==typeof o.clicked&&o.clicked.call(s)}s.handle_event("clicked",this)}}),this.$overlay.fadeIn(this.options.animations.open,function(){s.$document.addClass("modal-open")}),this.options.close_button&&this.$document.on("keyup.bs-modal",function(n){if(s.options.close_button&&27===n.which)s.close_modal("esc");else if(13===n.which){if(s.has_button()){var e=s.$modal.find(".bs-modal-bottom"),i=t(".bs-modal-btn-focus",e);i.length||(i=t(".bs-modal-btn-primary",e)),i.trigger("click")}s.keyup_unbind()}}),this.$modal.addClass(s.options.animations.open).addClass("skin-"+s.options.skin).show().delay(s.options.animations.delay).queue(function(t){"object"==typeof s.options.timer&&s.handle_timer(s.options.timer),t()}),n=!0,s.append_html()}},t.bs_modal=function(t){return new s(t)},t.bs_modal_template=function(t,n){s.prototype.templates[t]=n}}(jQuery);